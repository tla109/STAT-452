"0","library(stringr)"
"0",""
"0","all.MSPEs.LS.step <- array(0, dim = c(K, 2))"
"0","colnames(all.MSPEs.LS.step) <- c(""LS"", ""hybrid stepwise"")"
"0",""
"0","coefs.sw <- matrix(NA, nrow = K, ncol = 11)"
"0",""
"0","for (i in 1:K) {"
"0","  ### Split data"
"0","  data.train <- AQ[folds != i, ]"
"0","  data.valid <- AQ[folds == i, ]"
"0","  n.train <- nrow(data.train)"
"0",""
"0","  ### Get response vectors"
"0","  Y.train <- data.train$Ozone"
"0","  Y.valid <- data.valid$Ozone"
"0",""
"0","  ###################################################################"
"0","  ### First, let's quickly do LS so we have a reference point for ###"
"0","  ### how well the other models do.                               ###"
"0","  ###################################################################"
"0",""
"0","  fit.ls <- lm(Ozone ~ ., data = data.train)"
"0","  pred.ls <- predict(fit.ls, newdata = data.valid)"
"0","  MSPE.ls <- get.MSPE(Y.valid, pred.ls)"
"0","  all.MSPEs.LS.step[i, ""LS""] <- MSPE.ls"
"0","  "
"0","  step <- step("
"0","    object = lm(Ozone ~ 1, data = data.train), scope = list(upper = fit.ls), direction = ""both"","
"0","    k = log(nrow(data.train)), trace = 0)"
"0","  pred.sw <- predict(step, as.data.frame(data.valid))"
"0","  MSPE.sw <- get.MSPE(Y.valid, pred.sw)"
"0","  all.MSPEs.LS.step[i, ""hybrid stepwise""] <- MSPE.sw"
"0","}"
"0",""
"0","all.MSPEs.all = cbind(all.MSPEs.LS.step, all.MSPEs)"
"0","boxplot(all.MSPEs.all, main = paste0(""CV MSPEs over "", K, "" folds""))"
